<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Daily Math Quest ‚Äî 7+ Kids</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet"/>
<style>body{background:linear-gradient(135deg,#fceabb,#f8b500)}.brand{font-weight:800;letter-spacing:.5px}.card.glass{backdrop-filter:blur(8px);background:rgba(255,255,255,.9);box-shadow:0 10px 30px rgba(0,0,0,.08)}#question{font-size:2.2rem;font-weight:700}#answerInput{font-size:1.8rem;height:60px;text-align:center}.keypad .btn{width:100%;padding:16px;font-size:1.4rem;border-radius:14px}.emoji{font-size:2rem}.shake{animation:shake .4s}.pop{animation:pop .25s}@keyframes shake{10%,90%{transform:translate3d(-2px,0,0)}20%,80%{transform:translate3d(4px,0,0)}30%,50%,70%{transform:translate3d(-8px,0,0)}40%,60%{transform:translate3d(8px,0,0)}}@keyframes pop{0%{transform:scale(.8)}100%{transform:scale(1)}}.confetti{position:fixed;top:-10px;left:0;pointer-events:none;animation:fall linear forwards}.badge-sticker{font-size:2rem}.progress{height:14px;border-radius:999px}.hidden{display:none}.timer{font-weight:700}@keyframes fall{to{transform:translate3d(0,110vh,0) rotate(360deg);opacity:.9}}.toggle .form-check-input{transform:scale(1.2)}</style>
</head>
<body>
<div class="container py-4">
  <div class="d-flex align-items-center justify-content-between mb-3">
    <div class="h4 brand m-0">üéØ Daily Math Quest</div>
    <div class="text-end small">
      <div id="todayLabel"></div>
      <div>Streak: <span id="streak" class="fw-bold">0</span> üî•</div>
    </div>
  </div>

  <!-- Start Panel -->
  <div id="startPanel" class="card glass mb-3">
    <div class="card-body">
      <div class="row g-3 align-items-center">
        <div class="col-12 col-md-4">
          <label class="form-label mb-1 fw-semibold">Choose operations</label>
          <div class="d-flex gap-3 toggle">
            <div class="form-check form-switch">
              <input class="form-check-input" type="checkbox" id="opAdd" checked>
              <label class="form-check-label" for="opAdd">Plus (+)</label>
            </div>
            <div class="form-check form-switch">
              <input class="form-check-input" type="checkbox" id="opSub" checked>
              <label class="form-check-label" for="opSub">Minus (‚àí)</label>
            </div>
            <div class="form-check form-switch">
              <input class="form-check-input" type="checkbox" id="opMul">
              <label class="form-check-label" for="opMul">Times (√ó)</label>
            </div>
          </div>
        </div>
        <div class="col-12 col-md-4">
          <label class="form-label mb-1 fw-semibold">Difficulty</label>
          <select id="difficulty" class="form-select">
            <option value="easy" selected>Easy (0‚Äì10)</option>
            <option value="normal">Normal (0‚Äì20)</option>
          </select>
          <div class="form-text">30 questions per session. You‚Äôve got this! üí™</div>
        </div>
        <div class="col-12 col-md-4 text-md-end">
          <button id="startBtn" class="btn btn-success btn-lg px-4">Start Practice ‚ñ∂Ô∏è</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Quiz Panel -->
  <div id="quizPanel" class="card glass mb-3 hidden">
    <div class="card-body">
      <div class="row align-items-center mb-3">
        <div class="col-sm-7">
          <div class="progress" role="progressbar" aria-label="Progress">
            <div id="progressBar" class="progress-bar progress-bar-striped progress-bar-animated" style="width:0%"></div>
          </div>
          <div class="small mt-1">Question <span id="qIdx">1</span>/30 ‚Ä¢ <span class="timer" id="timer">0:00</span></div>
        </div>
        <div class="col-sm-5 text-sm-end mt-2 mt-sm-0">
          <span class="badge bg-primary me-2">Score: <span id="score">0</span></span>
          <span class="badge bg-secondary">Tries left: <span id="tries">2</span></span>
        </div>
      </div>

      <div class="text-center my-3">
        <div id="question" class="mb-3">3 + 4 = ?</div>
        <div class="row g-2 justify-content-center">
          <div class="col-10 col-md-6">
            <input id="answerInput" class="form-control form-control-lg text-center" inputmode="numeric" pattern="[0-9]*" autocomplete="off" placeholder="Type or use keypad" readonly/>
          </div>
          <div class="col-12">
            <div id="feedback" class="emoji"></div>
          </div>
        </div>
      </div>

      <div class="keypad mt-2">
        <div class="row g-2">
          <div class="col-4"><button class="btn btn-outline-dark" data-key="1">1</button></div>
          <div class="col-4"><button class="btn btn-outline-dark" data-key="2">2</button></div>
          <div class="col-4"><button class="btn btn-outline-dark" data-key="3">3</button></div>
          <div class="col-4"><button class="btn btn-outline-dark" data-key="4">4</button></div>
          <div class="col-4"><button class="btn btn-outline-dark" data-key="5">5</button></div>
          <div class="col-4"><button class="btn btn-outline-dark" data-key="6">6</button></div>
          <div class="col-4"><button class="btn btn-outline-dark" data-key="7">7</button></div>
          <div class="col-4"><button class="btn btn-outline-dark" data-key="8">8</button></div>
          <div class="col-4"><button class="btn btn-outline-dark" data-key="9">9</button></div>
          <div class="col-4"><button class="btn btn-outline-danger" data-action="clear">CLR</button></div>
          <div class="col-4"><button class="btn btn-outline-dark" data-key="0">0</button></div>
          <div class="col-4"><button class="btn btn-success" data-action="enter">OK</button></div>
          <div class="col-12"><button class="btn btn-outline-secondary w-100" data-action="back">‚Üê Backspace</button></div>
        </div>
      </div>
    </div>
  </div>

  <!-- End Panel -->
  <div id="endPanel" class="card glass hidden">
    <div class="card-body text-center">
      <div class="display-6 mb-2">Session Complete! üéâ</div>
      <div class="mb-3">You answered <b id="finalCorrect">0</b>/30 correctly in <b id="finalTime">0:00</b> (<b id="finalAcc">0%</b> accuracy).</div>
      <div class="mb-2">Achievements:</div>
      <div id="achievements" class="d-flex justify-content-center gap-2 flex-wrap mb-3"></div>
      <div class="mb-2 small">Best time: <span id="bestTime">‚Äî</span> ‚Ä¢ Best accuracy: <span id="bestAcc">‚Äî</span>%</div>
      <div class="mb-3 small">Streak is now <b id="finalStreak">0</b> days üî•</div>
      <div class="d-flex gap-2 justify-content-center">
        <button id="shareBtn" class="btn btn-outline-primary">Share Results</button>
        <button id="againBtn" class="btn btn-success">Play Again</button>
      </div>
    </div>
  </div>
</div>

<script>
(()=>{"use strict";
const QS=(s,p=document)=>p.querySelector(s);
const QSA=(s,p=document)=>[...p.querySelectorAll(s)];
const todayLabel=QS("#todayLabel"),streakEl=QS("#streak");
const startPanel=QS("#startPanel"),quizPanel=QS("#quizPanel"),endPanel=QS("#endPanel");
const progressBar=QS("#progressBar"),qIdxEl=QS("#qIdx"),timerEl=QS("#timer"),scoreEl=QS("#score"),triesEl=QS("#tries");
const questionEl=QS("#question"),answerInput=QS("#answerInput"),feedback=QS("#feedback");
const finalCorrect=QS("#finalCorrect"),finalTime=QS("#finalTime"),finalAcc=QS("#finalAcc");
const bestTimeEl=QS("#bestTime"),bestAccEl=QS("#bestAcc"),finalStreak=QS("#finalStreak"),achievements=QS("#achievements");
const startBtn=QS("#startBtn"),againBtn=QS("#againBtn"),shareBtn=QS("#shareBtn");
const opAdd=QS("#opAdd"),opSub=QS("#opSub"),opMul=QS("#opMul"),difficultySel=QS("#difficulty");
let totalQ=30,idx=0,score=0,tries=2,ans=0,startTime=0,ticker=null,ctx=null,lastShake=0;
function fmtTime(ms){const s=Math.floor(ms/1000);const m=Math.floor(s/60);const r=s%60;return m+":"+(r<10?"0"+r:r)}
function todayStr(){const d=new Date();return d.toISOString().slice(0,10)}
function setToday(){const d=new Date();todayLabel.textContent=d.toLocaleDateString(undefined,{weekday:"long",year:"numeric",month:"short",day:"numeric"})}
function lsGet(k,def=null){try{const v=localStorage.getItem(k);return v===null?def:JSON.parse(v)}catch{return def}}
function lsSet(k,v){try{localStorage.setItem(k,JSON.stringify(v))}catch{}}
function getStreak(){const last=lsGet("mq_last","");const streak=lsGet("mq_streak",0);const t=todayStr();if(!last){lsSet("mq_last",t);lsSet("mq_streak",0);return 0}
const diff=daysBetween(last,t);if(diff===0)return streak;if(diff===1)return streak+1;return 1}
function daysBetween(a,b){const da=new Date(a+"T00:00"),db=new Date(b+"T00:00");return Math.round((db-da)/86400000)}
function updateStreakOnFinish(){const last=lsGet("mq_last","");const t=todayStr();let s=lsGet("mq_streak",0);const diff=daysBetween(last||t,t);if(!last||diff>1)s=1;else if(diff===1)s=s+1;lsSet("mq_last",t);lsSet("mq_streak",s);return s}
function beep(freq=880,dur=0.12,type="sine",gain=0.06){try{ctx=ctx||new (window.AudioContext||window.webkitAudioContext)();const o=ctx.createOscillator(),g=ctx.createGain();o.type=type;o.frequency.value=freq;g.gain.value=gain;o.connect(g);g.connect(ctx.destination);o.start();setTimeout(()=>{o.stop();o.disconnect();g.disconnect()},dur*1000)}catch{}}
function randInt(a,b){return Math.floor(Math.random()*(b-a+1))+a}
function pick(arr){return arr[Math.floor(Math.random()*arr.length)]}
function bounds(){return difficultySel.value==="easy"?10:20}
function makeQuestion(){const ops=[];if(opAdd.checked)ops.push("+");if(opSub.checked)ops.push("‚àí");if(opMul.checked)ops.push("√ó");if(ops.length===0)ops.push("+");
const op=pick(ops);const max=bounds();
let a=0,b=0,txt="";let answer=0;
if(op==="+"){a=randInt(0,max);b=randInt(0,max);while(a+b>max) {a=randInt(0,max);b=randInt(0,max)} answer=a+b;txt=`${a} + ${b} = ?`}
else if(op==="‚àí"){a=randInt(0,max);b=randInt(0,a);answer=a-b;txt=`${a} ‚àí ${b} = ?`}
else{const m=difficultySel.value==="easy"?5:10;a=randInt(0,m);b=randInt(0,m);answer=a*b;txt=`${a} √ó ${b} = ?`}
return {txt:txt,ans:answer}}
function nextQ(){if(idx>=totalQ){finish();return}
tries=2;triesEl.textContent=tries;const q=makeQuestion();questionEl.textContent=q.txt;ans=q.ans;answerInput.value="";answerInput.classList.remove("is-valid","is-invalid");feedback.textContent="";qIdxEl.textContent=idx+1;progressBar.style.width=Math.round((idx/totalQ)*100)+"%"}
function submit(){const v=answerInput.value.trim();if(!v.length)return;const n=parseInt(v,10);if(Number.isNaN(n))return;const correct=n===ans;
if(correct){score++;scoreEl.textContent=score;answerInput.classList.remove("is-invalid");answerInput.classList.add("is-valid","pop");feedback.textContent="üåü Great!";beep(880,0.1,"square",0.05);setTimeout(()=>{answerInput.classList.remove("pop");idx++;nextQ()},450)}
else{tries--;triesEl.textContent=tries;answerInput.classList.remove("is-valid");answerInput.classList.add("is-invalid");feedback.textContent=tries>0?"ü§î Try again!":"‚ùå Answer: "+ans;beep(220,0.12,"sawtooth",0.06);const now=Date.now();if(now-lastShake>350){lastShake=now;quizPanel.classList.add("shake");setTimeout(()=>quizPanel.classList.remove("shake"),400)}if(tries<=0){setTimeout(()=>{idx++;nextQ()},800)}}
}
function start(){score=0;idx=0;scoreEl.textContent="0";progressBar.style.width="0%";startPanel.classList.add("hidden");endPanel.classList.add("hidden");quizPanel.classList.remove("hidden");startTime=Date.now();timerEl.textContent="0:00";if(ticker)clearInterval(ticker);ticker=setInterval(()=>{timerEl.textContent=fmtTime(Date.now()-startTime)},250);nextQ()}
function finish(){if(ticker)clearInterval(ticker);progressBar.style.width="100%";quizPanel.classList.add("hidden");endPanel.classList.remove("hidden");
const elapsed=Date.now()-startTime;const acc=Math.round((score/totalQ)*100);finalCorrect.textContent=score;finalTime.textContent=fmtTime(elapsed);finalAcc.textContent=acc+"%";
const bestT=lsGet("mq_best_time",null);const bestA=lsGet("mq_best_acc",0);
if(bestT===null||elapsed<bestT)lsSet("mq_best_time",elapsed);
if(acc>bestA)lsSet("mq_best_acc",acc);
const newBestT=lsGet("mq_best_time",elapsed),newBestA=lsGet("mq_best_acc",acc);
bestTimeEl.textContent=fmtTime(newBestT);bestAccEl.textContent=newBestA;
achievements.innerHTML="";
const stickers=[];
if(acc===100) stickers.push("üèÜ Perfect Prodigy");
if(acc>=90&&acc<100) stickers.push("‚≠ê Star Solver");
if(elapsed<=180000) stickers.push("‚ö° Speedy Learner");
if(score===totalQ) stickers.push("üéØ Goal Crusher");
const s=updateStreakOnFinish();finalStreak.textContent=s;streakEl.textContent=s;
if(s>=3) stickers.push("üî• Streak Hero ("+s+")");
stickers.forEach(t=>{const el=document.createElement("span");el.className="badge rounded-pill text-bg-warning badge-sticker";el.textContent=" "+t+" ";achievements.appendChild(el)});
confetti(140)}
function confetti(n=100){const em=["üéâ","‚ú®","üåü","üéà","‚≠ê"];for(let i=0;i<n;i++){const el=document.createElement("span");el.className="confetti";el.textContent=pick(em);const dur=(Math.random()*2.5+2.2).toFixed(2);const left=(Math.random()*100).toFixed(2)+"vw";const delay=(Math.random()*0.8).toFixed(2)+"s";el.style.cssText=`left:${left};animation-duration:${dur}s;animation-delay:${delay};font-size:${Math.random()*16+14}px`;document.body.appendChild(el);setTimeout(()=>el.remove(),(parseFloat(dur)+1)*1000)}}
function handleKeypad(e){const k=e.target.getAttribute("data-key");const act=e.target.getAttribute("data-action");if(k){answerInput.value=(answerInput.value+""+k).slice(0,4);beep(600,0.05,"sine",0.02)}else if(act==="back"){answerInput.value=answerInput.value.slice(0,-1)}else if(act==="clear"){answerInput.value=""}else if(act==="enter"){submit()}}
function enableKeyboard(){document.addEventListener("keydown",(e)=>{if(endPanel.classList.contains("hidden")&&quizPanel&&!quizPanel.classList.contains("hidden")){if(e.key>="0"&&e.key<="9"){e.preventDefault();answerInput.value=(answerInput.value+e.key).slice(0,4)}else if(e.key==="Backspace"){answerInput.value=answerInput.value.slice(0,-1)}else if(e.key==="Enter"){submit()}}})}
function share(){const txt=`I finished Daily Math Quest! ‚úÖ Score: ${score}/${totalQ}, Time: ${finalTime.textContent}, Accuracy: ${finalAcc.textContent}. Streak: ${finalStreak.textContent} days. Try to beat me!`;
if(navigator.share){navigator.share({title:"Daily Math Quest",text:txt}).catch(()=>copy(txt))}else{copy(txt)}}
function copy(t){navigator.clipboard?.writeText(t).then(()=>toast("Results copied!")).catch(()=>alert(t))}
function toast(msg){const el=document.createElement("div");el.className="position-fixed bottom-0 start-50 translate-middle-x mb-3 px-3 py-2 bg-dark text-white rounded-3 shadow";el.style.zIndex=9999;el.textContent=msg;document.body.appendChild(el);setTimeout(()=>el.remove(),1500)}
// init
setToday();streakEl.textContent=getStreak();QSA(".keypad .btn").forEach(b=>b.addEventListener("click",handleKeypad));enableKeyboard();
startBtn.addEventListener("click",start);againBtn.addEventListener("click",()=>{startPanel.classList.add("hidden");endPanel.classList.add("hidden");quizPanel.classList.add("hidden");start()});shareBtn.addEventListener("click",share);
})();
</script>
</body>
</html>
